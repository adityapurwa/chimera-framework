#verbose: true
out: output
vars:
    config:
        mongo_url: mongodb://localhost/project-template
        table: person
        user_id: "u001"
    sharingan_config:
        mongo_url: mongodb://localhost/project-template
        table: person
        show_deleted: true
        user_id: "u001"
    sharingan_projection:
        name: 1
        alias: 1
        _history: 1
        _deleted: 1
    new_data:
        name: "Tono Stark"
        alias: "Ironman"
    newer_data:
        name: "Toni Stark"
series:
    # insert new data
    - ("insert", config, new_data) -> node cck.mongo.core.js -> insert_result_1
    - error: 'insert_result_1.success==false'
    - ("getOne", config, insert_result_1.doc._id) -> node cck.mongo.core.js -> get_one_result
    - error: 'get_one_result.success==false'
    # update inserted data with a newer one
    - ("update", config, insert_result_1.doc, newer_data) -> node cck.mongo.core.js -> update_result
    - error: 'update_result.success==false'
    # insert another data
    - ("insert", config, new_data) -> node cck.mongo.core.js -> insert_result_2
    - error: 'insert_result_2.success==false'
    # delete the last one
    - ("delete", config, insert_result_2.doc._id) -> node cck.mongo.core.js -> delete_result
    - error: 'delete_result.success==false'
    # get the data
    - ("get", config) -> node cck.mongo.core.js -> get_result
    - error: 'get_result.success==false'
    # get it with sharingan activated ...
    - ("get", sharingan_config, "{}", sharingan_projection) -> node cck.mongo.core.js -> get_sharingan_result
    - error: 'get_sharingan_result.success==false'
    # show the result
    - (insert_result_1, get_one_result, update_result, insert_result_2, delete_result, get_result, get_sharingan_result)->->output
